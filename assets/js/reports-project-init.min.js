document.addEventListener("DOMContentLoaded", function () {
    fetch("https://app.obbak.es/get_data.php")
    .then(response => response.json())
    .then(data => {
        console.log("Datos recibidos:", data); // ğŸ” Verifica en consola
        
        // Verificar si los datos existen y estÃ¡n bien estructurados
        if (!data || !data.categorias || !Array.isArray(data.categorias) || data.categorias.length === 0) {
            console.warn("âš ï¸ No hay categorÃ­as o datos no vÃ¡lidos.");
            return;
        }


        // ConfiguraciÃ³n de los grÃ¡ficos
        let options = {
            chart: {
                height: 365,
                type: "area",
                toolbar: { show: false }
            },
            xaxis: {
                categories: data.categorias, // Las categorÃ­as provienen de la base de datos
                labels: { style: { fontSize: "11px", colors: "#64748b" } }
            },
            series: [
                { name: "Previsiones Descargas", data: data.tareas }, // Datos de tareas
                { name: "Descargas Reales", data: data.proyectos } // Datos de proyectos
            ],
            stroke: { curve: "smooth" },
            grid: { borderColor: "#ebebf3", strokeDashArray: 3 }
        };

        console.log("ConfiguraciÃ³n de ApexCharts:", options); // ğŸ“Œ DepuraciÃ³n

        // AsegÃºrate de que el contenedor estÃ© presente en el DOM
        const chartContainer = document.querySelector("#project-statistics-chart");

        if (chartContainer) {
            let chart = new ApexCharts(chartContainer, options);
            chart.render();  // Es importante llamar a render() para dibujar el grÃ¡fico
        } else {
            console.error("âŒ No se encontrÃ³ el contenedor del grÃ¡fico.");
        }
    })
    .catch(error => console.error("âŒ Error al obtener datos:", error));
});
